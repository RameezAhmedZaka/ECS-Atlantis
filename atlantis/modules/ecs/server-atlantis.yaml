
 repos:
  - id: github.com/RameezAhmedZaka/ECS-Atlantis
    allow_custom_workflows: true
    allowed_overrides:
      - apply_requirements
      - workflow
      - plan_requirements
      - repo_locks
    apply_requirements: []
    repo_locking: false  
    pre_workflow_hooks:
      - run: |
          echo "Clearing all PR workspaces for this repo..."
          REPOS_DIR="/atlantis-data/repos/github.com/RameezAhmedZaka/ECS-Atlantis"
          if [ -d "$REPOS_DIR" ]; then
            rm -rf "$REPOS_DIR"/*
            echo "All PR workspaces cleared."
          else
            echo "Repo directory does not exist: $REPOS_DIR"
          fi

          # Run your config generator
          chmod +x ./repo-config-generator.sh
          ./repo-config-generator.sh
        description: Clearing old PRs and generating configs











    # pre_workflow_hooks:
    #   - run: |
    #       set -e
    #       echo "Running config-generator from $(pwd)"
    #       if [ -f "./repo-config-generator.sh" ]; then
    #           chmod +x ./repo-config-generator.sh
    #           ./repo-config-generator.sh
    #           echo "Config generation completed successfully"
    #       else
    #           echo "Warning: repo-config-generator.sh not found"
    #           exit 0  # Don't fail if script doesn't exist
    #       fi
    #     description: Generating configs
