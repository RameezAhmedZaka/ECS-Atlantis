version: 3
workflows:
  my-custom-workflow:
    plan:
      steps:
        - run:
            name: "Setup environment"
            command: ./setup-env.sh
        - init:
            extra_args: ["-backend-config=env/staging/stage.conf"]
        - plan:
            extra_args: ["-var-file=config/stage.tfvars"]
    apply:
      steps:
        - apply:
            extra_args: ["-var-file=config/stage.tfvars"]
